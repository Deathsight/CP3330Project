{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\StudentAdmin\\\\Documents\\\\GitHub\\\\CP3330Project\\\\mallprojectreact\\\\src\\\\Renting\\\\RentingCreate.js\";\nimport React from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport DB from \"../db.js\";\nimport Button from \"react-bootstrap/Button\";\nimport Form from \"react-bootstrap/Form\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport Table from \"react-bootstrap/Table\";\nimport Auth from \"../auth\";\nexport default class RentingCreate extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      renter: \"\",\n      security: [],\n      Description: \"\",\n      Capacity: \"\",\n      isCreated: false,\n      store: null,\n      Date: \"\",\n      StartDateTime: null,\n      EndDateTime: null\n    };\n\n    this.handleStartDate = event => {\n      //const movie = await DB.assets.findOne(this.props.match.params.id);\n      //Customer has selected date\n      //now display all time slots on that date\n      //with availble/unavailable made obvious\n      this.setState({\n        Date: event.target.value\n      });\n    };\n\n    this.handleEndDate = event => {\n      //const movie = await DB.assets.findOne(this.props.match.params.id);\n      //Customer has selected date\n      //now display all time slots on that date\n      //with availble/unavailable made obvious\n      this.setState({\n        Date: event.target.value\n      });\n    };\n\n    this.handleTime = (event, Time) => {\n      this.setState({\n        Time\n      });\n    };\n\n    this.handleBook = async () => {\n      console.log(this.state.Date);\n      console.log(this.state.Time);\n      console.log(this.state.movie.Id);\n\n      if (await DB.assetBookings.create({\n        RenterEmail: this.state.renter,\n        StartDateTime: \"\".concat(this.state.StartDateTime, \"T00:00:00\"),\n        EndDateTime: \"\".concat(this.state.EndDateTime, \"T00:00:00\"),\n        TotalPrice: 0,\n        Status: \"\"\n      })) {\n        this.setState({\n          isCreated: true\n        });\n      }\n    };\n\n    this.isAvailable = time => {\n      // search for time in all times in\n      //this.state.movie.assetBookings.Bookings;\n      const search = \"\".concat(this.state.Date, \"T\").concat(time);\n      return this.state.movie.AssetBookings.filter(assetBooking => assetBooking.Booking.StartDateTime === search).length === 0;\n    };\n\n    this.handleDescription = event => {\n      this.setState({\n        Description: event.target.value\n      });\n    };\n\n    this.handleCapacity = event => {\n      this.setState({\n        Capacity: event.target.value\n      });\n    };\n  }\n\n  async componentDidMount() {\n    const store = await DB.Stores.findOne(this.props.match.params.id);\n    const renter = await Auth.username();\n    const security = await DB.Securities.findAll();\n    console.log(store);\n    this.setState({\n      store\n    });\n    this.setState({\n      security\n    });\n    this.setState({\n      renter\n    });\n  }\n\n  render() {\n    return this.state.isCreated ? React.createElement(Redirect, {\n      to: \"/profile\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, \"Crate a Store Renting\"), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"Description: \"), React.createElement(\"dd\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, this.state.movie && \"\".concat(this.state.movie.Description, \" (\").concat(this.state.movie.PricingModel.Amount, \")\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, \"date: \"), React.createElement(\"input\", {\n      type: \"date\",\n      onChange: this.handleDate,\n      value: this.state.Date,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"Capacity: \"), React.createElement(\"input\", {\n      type: \"text\",\n      onChange: this.handleCapacity,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }), React.createElement(Button, {\n      onClick: this.handleBook,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, \"Create\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), this.state.Date != \"\" && this.state.Times.map(time => React.createElement(\"li\", {\n      key: time,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, time, this.state.movie && this.isAvailable(time) && React.createElement(Form.Check, {\n      inline: true,\n      type: \"radio\",\n      name: \"time\",\n      onChange: event => this.handleStartTime(event, time),\n      value: this.state.Time === time,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }))));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/StudentAdmin/Documents/GitHub/CP3330Project/mallprojectreact/src/Renting/RentingCreate.js"],"names":["React","DB","Button","Form","Link","Redirect","Table","Auth","RentingCreate","Component","state","renter","security","Description","Capacity","isCreated","store","Date","StartDateTime","EndDateTime","handleStartDate","event","setState","target","value","handleEndDate","handleTime","Time","handleBook","console","log","movie","Id","assetBookings","create","RenterEmail","TotalPrice","Status","isAvailable","time","search","AssetBookings","filter","assetBooking","Booking","length","handleDescription","handleCapacity","componentDidMount","Stores","findOne","props","match","params","id","username","Securities","findAll","render","PricingModel","Amount","handleDate","Times","map","handleStartTime"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport DB from \"../db.js\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport Table from \"react-bootstrap/Table\";\r\nimport Auth from \"../auth\";\r\n\r\nexport default class RentingCreate extends React.Component {\r\n  state = {\r\n    renter: \"\",\r\n    security: [],\r\n    Description: \"\",\r\n    Capacity: \"\",\r\n    isCreated: false,\r\n    store: null,\r\n    Date: \"\",\r\n    StartDateTime: null,\r\n    EndDateTime: null\r\n  };\r\n\r\n  async componentDidMount() {\r\n    const store = await DB.Stores.findOne(this.props.match.params.id);\r\n    const renter = await Auth.username();\r\n    const security = await DB.Securities.findAll();\r\n    console.log(store);\r\n    this.setState({ store });\r\n    this.setState({ security });\r\n    this.setState({ renter });\r\n  }\r\n\r\n  handleStartDate = event => {\r\n    //const movie = await DB.assets.findOne(this.props.match.params.id);\r\n    //Customer has selected date\r\n    //now display all time slots on that date\r\n    //with availble/unavailable made obvious\r\n\r\n    this.setState({ Date: event.target.value });\r\n  };\r\n  handleEndDate = event => {\r\n    //const movie = await DB.assets.findOne(this.props.match.params.id);\r\n    //Customer has selected date\r\n    //now display all time slots on that date\r\n    //with availble/unavailable made obvious\r\n\r\n    this.setState({ Date: event.target.value });\r\n  };\r\n\r\n  handleTime = (event, Time) => {\r\n    this.setState({ Time });\r\n  };\r\n\r\n  handleBook = async () => {\r\n    console.log(this.state.Date);\r\n    console.log(this.state.Time);\r\n    console.log(this.state.movie.Id);\r\n\r\n    if (\r\n      await DB.assetBookings.create({\r\n        RenterEmail: this.state.renter,\r\n        StartDateTime: `${this.state.StartDateTime}T00:00:00`,\r\n        EndDateTime: `${this.state.EndDateTime}T00:00:00`,\r\n        TotalPrice: 0,\r\n        Status: \"\"\r\n      })\r\n    ) {\r\n      this.setState({ isCreated: true });\r\n    }\r\n  };\r\n\r\n  isAvailable = time => {\r\n    // search for time in all times in\r\n    //this.state.movie.assetBookings.Bookings;\r\n    const search = `${this.state.Date}T${time}`;\r\n    return (\r\n      this.state.movie.AssetBookings.filter(\r\n        assetBooking => assetBooking.Booking.StartDateTime === search\r\n      ).length === 0\r\n    );\r\n  };\r\n\r\n  handleDescription = event => {\r\n    this.setState({ Description: event.target.value });\r\n  };\r\n  handleCapacity = event => {\r\n    this.setState({ Capacity: event.target.value });\r\n  };\r\n\r\n  render() {\r\n    return this.state.isCreated ? (\r\n      <Redirect to=\"/profile\" />\r\n    ) : (\r\n      <div>\r\n        <h2>Crate a Store Renting</h2>\r\n\r\n        <label>Description: </label>\r\n        <dd>\r\n          {this.state.movie &&\r\n            `${this.state.movie.Description} (${this.state.movie.PricingModel.Amount})`}\r\n        </dd>\r\n        <br></br>\r\n        <label>date: </label>\r\n        <input\r\n          type=\"date\"\r\n          onChange={this.handleDate}\r\n          value={this.state.Date}\r\n        ></input>\r\n        <br></br>\r\n        <label>Capacity: </label>\r\n        <input type=\"text\" onChange={this.handleCapacity}></input>\r\n        <br></br>\r\n        <Button onClick={this.handleBook}>Create</Button>\r\n        <br></br>\r\n        {this.state.Date != \"\" &&\r\n          this.state.Times.map(time => (\r\n            <li key={time}>\r\n              {time}\r\n              {this.state.movie && this.isAvailable(time) && (\r\n                <Form.Check\r\n                  inline\r\n                  type=\"radio\"\r\n                  name=\"time\"\r\n                  onChange={event => this.handleStartTime(event, time)}\r\n                  value={this.state.Time === time}\r\n                ></Form.Check>\r\n              )}\r\n            </li>\r\n          ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}