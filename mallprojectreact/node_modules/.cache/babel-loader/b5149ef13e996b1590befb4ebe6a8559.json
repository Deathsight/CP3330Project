{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\StudentAdmin\\\\Documents\\\\GitHub\\\\CP3330Project\\\\mallprojectreact\\\\src\\\\Login.js\";\nimport React from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport Auth from './auth';\nimport DB from \"./db.js\";\nimport { Redirect } from \"react-router-dom\"; // import Table from 'react-bootstrap/Table';\n\nexport default class Login extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      Email: \"\",\n      Password: \"\",\n      isLoggedIn: false\n    };\n\n    this.handleEmail = event => {\n      this.setState({\n        Email: event.target.value\n      });\n    };\n\n    this.handlePassword = event => {\n      this.setState({\n        Password: event.target.value\n      });\n    };\n\n    this.handleLogin = async () => {\n      const response = await fetch(\"/Token\", {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        body: \"grant_type=password&username=\".concat(this.state.Email, \"&password=\").concat(this.state.Password)\n      });\n      const json = await response.json();\n      console.log('json', json);\n      console.log('response', response);\n\n      if (response.ok) {\n        console.log('Logged in successfully');\n        Auth.login(json.access_token, json.userName);\n\n        if (!(await DB.Customers.create())) {\n          console.log('Customer creation failed');\n        }\n\n        this.setState({\n          isLoggedIn: true\n        });\n      }\n    };\n  }\n\n  render() {\n    return this.state.isLoggedIn ? React.createElement(Redirect, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, React.createElement(Form.Group, {\n      controlId: \"LoginEmail\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }, \"Email address\"), React.createElement(Form.Control, {\n      type: \"email\",\n      placeholder: \"Enter email\",\n      onChange: this.handleEmail,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    })), React.createElement(Form.Group, {\n      controlId: \"LoginPassword\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, \"Password\"), React.createElement(Form.Control, {\n      type: \"password\",\n      placeholder: \"Password\",\n      onChange: this.handlePassword,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    })), React.createElement(Button, {\n      variant: \"primary\",\n      onClick: this.handleLogin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, \"Login\"));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/StudentAdmin/Documents/GitHub/CP3330Project/mallprojectreact/src/Login.js"],"names":["React","Button","Form","Auth","DB","Redirect","Login","Component","state","Email","Password","isLoggedIn","handleEmail","event","setState","target","value","handlePassword","handleLogin","response","fetch","method","headers","body","json","console","log","ok","login","access_token","userName","Customers","create","render"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Auth from './auth'\r\nimport DB from \"./db.js\";\r\nimport { Redirect } from \"react-router-dom\";\r\n// import Table from 'react-bootstrap/Table';\r\n\r\nexport default class Login extends React.Component {\r\n    state = {\r\n        Email: \"\",\r\n        Password: \"\",\r\n        isLoggedIn: false\r\n    }\r\n\r\n    handleEmail = (event) => {\r\n        this.setState({Email: event.target.value})\r\n    }\r\n\r\n    handlePassword = (event) => {\r\n        this.setState({Password: event.target.value})\r\n    }\r\n\r\n    handleLogin = async () => {\r\n\r\n        const response = await fetch(`/Token`,{\r\n            method : 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/x-www-form-urlencoded'\r\n            },\r\n            body: `grant_type=password&username=${this.state.Email}&password=${this.state.Password}`\r\n        })\r\n        const json = await response.json()\r\n        console.log('json',json)\r\n\r\n        console.log('response', response)\r\n        if(response.ok){\r\n            console.log('Logged in successfully')\r\n            Auth.login(json.access_token, json.userName)\r\n            if(!await DB.Customers.create()){\r\n                console.log('Customer creation failed')\r\n            }\r\n            this.setState({ isLoggedIn: true });\r\n        }\r\n    }\r\n\r\n    render(){\r\n        return this.state.isLoggedIn ? (\r\n            <Redirect to = \"/\"/>\r\n          ) : (\r\n            <div>\r\n                <Form.Group controlId=\"LoginEmail\">\r\n                    <Form.Label>Email address</Form.Label>\r\n                    <Form.Control type=\"email\" placeholder=\"Enter email\" onChange={this.handleEmail}/>\r\n                </Form.Group>\r\n\r\n                <Form.Group controlId=\"LoginPassword\">\r\n                    <Form.Label>Password</Form.Label>\r\n                    <Form.Control type=\"password\" placeholder=\"Password\" onChange={this.handlePassword}/>\r\n                </Form.Group>\r\n                <Button variant=\"primary\" onClick={this.handleLogin}>\r\n                    Login\r\n                </Button>\r\n            </div>\r\n        );\r\n    }\r\n}    "]},"metadata":{},"sourceType":"module"}